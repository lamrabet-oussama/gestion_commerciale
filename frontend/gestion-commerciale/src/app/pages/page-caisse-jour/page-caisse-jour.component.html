<div class="caisse-page">
  <div class="page-container">
    <div class="card-responsive p-3 p-md-4">
      <h4 class="text-center text-primary mb-3 mb-md-4">
        <i class="fas fa-info-circle me-2"></i>Caisse Journalière
      </h4>





      <!-- Form -->
      <form class="p-2 rounded w-sm bg-white">
    <div class="row g-4">
      <!-- Première colonne -->
      <div class="col-12 col-md-6">
       <div class="mb-3">

<label for="date" class="form-label">Date</label>
<input
          type="date"
          [(ngModel)]="selectedDate"
          (ngModelChange)="onDateChange()"
          class="form-control date-input"
          name="dateInput"
          id="dateInput"
          [max]="maxDate"
        />
</div>

      </div>

      <!-- Deuxième colonne -->
      <div class="col-12 col-md-6">
        <div class="mb-3">
          <label for="ref" class="form-label">Utilisateurs</label>
        </div>

          <select class="form-select form-control"
        [(ngModel)]="selectedUser"
        id="user"
        name="user"
        (ngModelChange)="onUserSelected($event)">
  <option *ngFor="let user of users" [ngValue]="user">
    {{ user.username }}
  </option>
</select>
</div>
   </div>
  </form>
</div>

    <!-- Liste des bons -->
    <div class="bons-section mt-4 mt-md-5">
      <div class="section-header d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-3 gap-3">
        <h4 class="section-title mb-0">Liste des Bons</h4>
      </div>

      <!-- Table responsive wrapper -->
      <div class="table-responsive" style="max-height: 800px; overflow-y: auto;">
        <table class="table table-bordered table-hover text-center mb-0">
          <thead class="table-dark sticky-top">
          <tr >
            <th class="text-nowrap" style="width:30%">Bon</th>
            <th >Montant</th> <!-- s'étire -->
            <th class="text-nowrap d-none d-md-table-cell" >Espèce</th>
            <th class="text-nowrap d-none d-md-table-cell" >Chèque</th>
            <th class="text-nowrap">Crédit</th>
            <th class="text-nowrap" style="width: 20%;">Détails</th>
          </tr>
          </thead>
          <tbody>
          <tr class="pointer" *ngFor="let bon of caisseJourDto.bons"   >
            <td class="text-nowrap">{{ bon.serie }}</td>
            <td class="text-truncate" style="max-width: 150px;">{{bon.montant}}</td>
            <td class="d-none d-md-table-cell text-truncate" style="max-width: 100px;" >{{bon.espece}}</td>
            <td class="d-none d-md-table-cell text-truncate" style="max-width: 100px;" >{{bon.cheque}}</td>
            <td class="text-nowrap">{{bon.credit}}</td>
            <td class="text-nowrap">{{bon.nomTier}}</td>

          </tr>
          </tbody>
        </table>
      </div>
<div class="totals-section">
  <div class="row g-3 mb-4">
    <div class="col-12 col-md-4">
      <div class="total-card card-responsive shadow-sm">
        <div class="card-body text-center">
          <h6 class="card-title text-muted mb-2">Montant Total</h6>
          <p class="card-value fw-bold text-primary mb-0">{{ caisseJourDto.totalMontant }} DH</p>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="total-card card-responsive shadow-sm">
        <div class="card-body text-center">
          <h6 class="card-title text-muted mb-2">Total Espèce</h6>
          <p class="card-value fw-bold text-success mb-0">{{ caisseJourDto.totalEspece }} DH</p>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="total-card card-responsive shadow-sm">
        <div class="card-body text-center">
          <h6 class="card-title text-muted mb-2">Total Chèque</h6>
          <p class="card-value fw-bold text-info mb-0">{{ caisseJourDto.totalCheque }} DH</p>
        </div>
      </div>
    </div>
  </div>

  <div class="print-section text-center">
    <button type="button" class="btn btn-primary btn-responsive" (click)="downloadCaisseJourPdf()">
      <i class="fas fa-print me-2"></i>
      <span class="btn-text">Imprimer</span>
    </button>
  </div>
</div>

    </div>
  </div>
</div>
