<div class="inventory-container">

  <!-- Filtre année -->
  <div class="d-flex justify-content-end mb-3">
    <div class="year-input">
      <label for="year" class="form-label fw-semibold">Année</label>
      <input
        type="number"
        [(ngModel)]="selectedYear"
        (ngModelChange)="onYearChange($event)"
        class="form-control"
        name="yearInput"
        id="yearInput"
        [max]="maxYear"
        placeholder="YYYY"
      />
    </div>
  </div>

  <div class="row g-3">
    <!-- Tableau de Stock -->
    <div class="col-12 col-lg-6">
      <div class="table-card shadow-sm">
        <div class="table-header">
          <h5 class="table-title">
            <i class="bi bi-boxes me-2"></i>Stock Inventaire
          </h5>
        </div>
        <div class="table-wrapper">
          <table class="custom-table">
            <thead>
            <tr>
              <th class="text-start">Article</th>
              <th class="text-end">Stock</th>
            </tr>
            </thead>
            <tbody>
            <tr class="pointer"
                *ngFor="let item of mesArticles$ | async"
                (click)="onArticleSelect(item.cod ?? 0)"
                [class.selected]="item.cod === selectedArticleId">
              <td class="item-name">{{ item.designation }}</td>
              <td class="text-end">
                  <span class="quantity-badge">
                    {{ item.stock | number:'1.2-2' }}
                  </span>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Tableau des Mouvements -->
    <div class="col-12 col-lg-6">
      <div class="table-card shadow-sm">
        <div class="table-header">
          <h5 class="table-title">
            <i class="bi bi-arrow-left-right me-2"></i>Mouvements
          </h5>
        </div>
        <div class="table-wrapper">
          <table class="custom-table">
            <thead>
            <tr>
              <th>Date</th>
              <th>Libellé</th>
              <th class="text-end d-none d-sm-table-cell">Achat</th>
              <th class="text-end d-none d-sm-table-cell">Vente</th>
              <th class="text-end">Stock</th>
            </tr>
            </thead>
            <tbody>
            <!-- Ligne Stock initial -->
            <tr>
              <td class="label-cell">{{ fluxesNormal.dateInitial }}</td>
              <td class="label-cell">Stock Initial</td>
              <td></td>
              <td></td>
              <td class="text-end">
                <span class="quantity-badge">{{ fluxesNormal.stockInitial }}</span>
              </td>
            </tr>

            <!-- Lignes flux -->
            <tr *ngFor="let f of fluxesNormal.fluxes">
              <td class="label-cell">{{ f.dateFlux }}</td>
              <td class="label-cell">{{ f.libelle }}</td>
              <td class="text-end d-none d-sm-table-cell fw-bold">{{ f.achat }}</td>
              <td class="text-end d-none d-sm-table-cell fw-bold">{{ f.vente }}</td>
              <td class="text-end fw-bold">
                <span class="quantity-badge">{{ f.stock }}</span>
              </td>
            </tr>

            <!-- Ligne Total -->

            </tbody>
          </table>
          <div class="flex-row justify-content-center align-items-center p-3 gap-4 w-100">
            <div></div>
            <div class="fw-semibold">Total</div>
            <div class="text-end d-none d-sm-table-cell m-6">
              <span class="quantity-badge warning">Achat: {{ fluxesNormal.totalEntres }}</span>
            </div>
            <div class="text-end d-none d-sm-table-cell">
              <span class="quantity-badge warning">Vente: {{ fluxesNormal.totalSorties }}</span>
            </div>
            <div></div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
